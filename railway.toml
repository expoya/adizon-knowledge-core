# =============================================================================
# Adizon Knowledge Core - Root Railway Configuration
# =============================================================================
#
# RAILWAY DEPLOYMENT GUIDE:
# -------------------------
# This project requires MULTIPLE Railway services. Deploy as follows:
#
# 1. BACKEND SERVICE:
#    - Create new service from GitHub repo
#    - Set Root Directory: /backend
#    - Add PostgreSQL plugin (provides DATABASE_URL)
#    - Set environment variables (see .env.example)
#
# 2. FRONTEND SERVICE:
#    - Create new service from same GitHub repo
#    - Set Root Directory: /frontend
#    - Set build arg: VITE_API_URL = https://your-backend.railway.app/api/v1
#
# 3. EXTERNAL SERVICES NEEDED:
#    - Neo4j: Use Neo4j Aura (cloud) or deploy as Docker service
#    - MinIO: Use Railway's Object Storage or external S3/MinIO
#
# =============================================================================

# Default: Backend service (if deploying from root)
[build]
builder = "dockerfile"
dockerfilePath = "backend/Dockerfile"

[deploy]
healthcheckPath = "/health"
healthcheckTimeout = 100
restartPolicyType = "on_failure"
restartPolicyMaxRetries = 3

# =============================================================================
# CRONJOB: CRM Sync (3x t채glich: 07:00, 10:00, 14:00)
# =============================================================================
# F체hrt automatisch Full Sync durch (Updates via MERGE ON MATCH SET)
# Dauer: ~6 Minuten f체r 58k Entities + 73k Relationships
# Frequenz: 3x t채glich reduziert API-Kosten erheblich
# 
# SETUP:
# 1. Setze CRON_API_KEY in Railway Environment Variables
# 2. Deploy mit: railway up
# 3. Monitor mit: railway logs --filter "CRM Sync"
#
[[crons]]
schedule = "0 7,10,14 * * *"
command = "curl -X POST -H 'X-API-Key: ${CRON_API_KEY}' https://${RAILWAY_PUBLIC_DOMAIN}/api/v1/crm-sync"
